# EMI(Enhanced Media Interface)

EMI is a media server like Jellyfin or Plex

- Built to learn more about Elixir Umbrella apps


*Generated by ChatGPT for now*

It is a modular, umbrella-structured media server built using Elixir and Phoenix. Inspired by projects like Jellyfin, Emi supports media ingestion, transcoding, streaming, and user management through scalable, distributed, and fault-tolerant Elixir processes.

---

## Features

- LiveView-powered web interface for browsing and playing media
- On-demand transcoding and streaming via FFmpeg
- Background processing (file scan, subtitle fetching)
- Real-time updates with Phoenix PubSub
- Secure user authentication and profiles
- Scalable architecture via isolated umbrella apps

---

## Umbrella Architecture

The umbrella is composed of several apps, each with a clearly defined role:

### `emi_web`
> The Phoenix interface (LiveView & JSON API)

- Responsible for routing, rendering views, and serving assets
- Receives user interactions and delegates to other apps
- Depends on:
  - `emi_core`
  - `emi_stream`
  - `emi_accounts`
  - `emi_notifier`

---

### `emi_core`
> Business logic and media library management

- Scans directories, manages media state, builds queries
- We use TheMovieDatabase(TMDB) and MusicBrainz to fetch metadata.
- We will also use fanart.tv for album art in association with the URLs provided by TMDB
- Depends on:
  - `emi_db`
  - `emi_notifier`

---

### `emi_stream`
> Streaming and transcoding engine

- Interfaces with FFmpeg to serve or transcode content
- Serves large files via chunked streaming
- Depends on:
  - `emi_db`
  - `emi_core`

---

### `emi_accounts`
> Authentication, sessions, and user profiles

- Manages sign-in, sessions, tokens, and user preferences
- Depends on:
  - `emi_db`

---

### `emi_ingest`
> Background job processor

- Scans folders, extracts metadata, fetches subtitles
- Runs asynchronously using Oban (or native GenServers)
- Depends on:
  - `emi_core`
  - `emi_db`
  - `emi_notifier`

---

### `emi_db`
> Shared schemas and Ecto repo

- Provides a central place for defining all database schemas
- Exposes Ecto queries, migrations, and database configuration
- **No dependencies on other apps**

---

### `emi_notifier`
> PubSub wrapper and event broadcaster

- Sends real-time notifications across apps via Phoenix PubSub
- Used to notify clients of new media, updates, and playback state
- Depends on:
  - `emi_db` (optionally for metadata)

---

## Notes

Transcoding is handled via FFmpeg CLI â€” ensure it is installed.

For background jobs, Oban is used in media_ingest (requires a database like Postgres).

Live updates are powered by Phoenix Channels and PubSub.

To extend the system (e.g., add device sync, external metadata APIs), add new umbrella apps with clean interfaces.

### TBD
figure out how to use the (membrane framework)[https://membrane.stream/].
